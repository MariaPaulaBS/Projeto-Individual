<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <link rel="stylesheet" href="./css/hf.css">
    <link rel="stylesheet" href="./css/quiz.css">

</head>

<body>
    <div id="all" style="display: block;" >
    <div  class="all-quiz">
        <div class="lateral">
            <a href="entro.html"> <img class="icon" src="assets/img/botao-de-inicio (1).png" alt=""></a>
            <a href="livros.html"> <img class="icon" src="assets/img/pilha-de-tres-livros.png" alt=""></a>
            <a href="./dashboard/dashboard.html"> <img class="icon" src="assets/img/perfil-de-usuario (1).png" alt=""></a>
        </div>
        <div class="quiz-personalidade" id="comeco1">
            <div class="quiz-sobre">
                <div class="div-img1">
                    <h1>Quem é você no Círculo Intimo?</h1>
                    <img class="img1" src="./assets/img/cirulo intimo2.jpg" alt="">
                </div>
                <div class="text-box">
                   <a href="quiz-personalidade.html"> <button  class="botao">Começar Quiz de personalidade</button></a>
    
                </div>
            </div>
        </div>
        <div class="quiz-sobre">
            <div class="div-img1">
                <h1>O quando você conhece ACOTAR?</h1>
                <img class="img1" src="./assets/img/feyre.velaris.jpg" alt="">
            </div>
            <div class="text-box">
                <button onclick="comecar()" id="comeco" class="botao">Começar Quiz</button>

            </div>
        </div>
    </div>
</div>
        <div id="quiz" style="display: none;">
            <div class="quiz-1">
                <div id="imgV"></div>
                <div id="div_perguntas" style="color: white;"></div><br>

                <button id="A" class="botaoQuiz" style="background-color: white;" onclick="ver(this.name, this.id) ; " name="A">O
                    amor</button><br>
                <button id="B" class="botaoQuiz" style="background-color: white;" onclick="ver(this.name, this.id) ;" name="B">O
                    calderão</button><br>
                <button id="C" class="botaoQuiz" style="background-color: white;" onclick="ver(this.name, this.id) ;" name="C">A
                    ganância</button><br>
                <button id="D" class="botaoQuiz" style="background-color: white;" onclick="ver(this.name, this.id) ;" name="D">A
                    mágia</button><br>


                <div id="msg" style="color: white;"></div>
            </div>



        </div>

        
        <footer>
            <p>
                Copyright © Maria <3 | Todos os direitos reservado. </p>
        </footer>
</body>

</html>
<script>

    var contador = 0;
    var perguntas = ['No primeiro livro qual era a resposta do enigma da Amarantha em sobre a montanha?',
        'Qual é o capítulo que a Feyre perdoa o Rhys por ter mentido sobre a parceria?',
        'Quantas cortes existem em Prithyan?',
        'Quem é o pai do Lucien?',
        'Qual é o nome do feérico que Feyre mata no começo de corte de espinhos e rosas?'];
     var img= ['<img  class = "img-Vetor" src="assets/img/pergunta1.jpg" alt="">',
     '<img class = "img-Vetor" src="assets/img/perso/feyre e rhys 1.jpg" alt="">',
     '<img class = "img-Vetor" src="assets/img/prythian.jpg" alt="">',
     '<img class = "img-Vetor" src="assets/img/perso/lucian.jpg" alt="">',
'<img class = "img-Vetor" src="assets/img/ultimaPergunta.jpg" alt="">'

    ];

    var respostas = ['A', 'C', 'B', 'A', 'D'];


    var acerto = 0;
    var erro = 0;

    var cont = 0;


    //     function changeColor(color) {
    //                 document.nomeBotão.style.background = color;
    //      }

    //      function bgChange() {

    //   document.button.style.backgroundColor = 'green';
    // }



    function comecar() {
        all.style.display = 'none';
        comeco1.style.display = 'none';
        comeco.style.display = 'none';
        quiz.style.display = 'block';


        div_perguntas.innerHTML = perguntas[contador];
        imgV.innerHTML = img[contador];
        limpar()
    }




    function terminar() {

        if (contador == perguntas.length - 1) {
            // contador = 0;
          
            cadastrarQuiz()
        } else {
            contador++;
            cont++;
        }
        if (contador < perguntas.length) {
            div_perguntas.innerHTML = `${perguntas[contador]}`
            imgV.innerHTML = img[contador];

        }


        if (contador == 1) {


            A.innerHTML = `56`;
            B.innerHTML = `34`;
            C.innerHTML = `55`;
            D.innerHTML = `40`;

        }

        if (contador == 2) {


            A.innerHTML = `6`;
            B.innerHTML = `7`;
            C.innerHTML = `10`;
            D.innerHTML = `9`;

        }
        if (contador == 3) {


            A.innerHTML = `Helion`;
            B.innerHTML = `Eris`;
            C.innerHTML = `Tamlin`;
            D.innerHTML = `Beron`;

        }

        if (contador == 4) {


            A.innerHTML = `Aleksander`;
            B.innerHTML = `Adam`;
            C.innerHTML = `Andrak`;
            D.innerHTML = `Andras`;



        }





    }


    function ver(nomeBotão, idBotao) {


        if (cont == contador) {


            if (respostas[contador] == nomeBotão) {
                acerto++

                console.log(acerto)
                console.log(idBotao)

                document.getElementById(idBotao).style.backgroundColor = 'green'

                // changeColor('green');
                // bgChange() 

                setTimeout(() => {
                    terminar()
                    document.getElementById(idBotao).style.backgroundColor = 'white'
                    // changeColor('white');

                }, 1000)

            }
            else {
                erro++
                console.log(erro)
                  document.getElementById(idBotao).style.backgroundColor ='red'



                setTimeout(() => {
                    terminar()
                    document.getElementById(idBotao).style.backgroundColor  = 'white'
                }, 1000)

            }
        }
    }







    function cadastrarQuiz() {
        // aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo

        var errosVar = Number(erro);
        var acertosVar = Number(acerto);
        var fkUsuarioVar = Number(sessionStorage.getItem('ID_USUARIO'))

        console.log(acertosVar)
        console.log(errosVar)
        console.log(fkUsuarioVar)
        // Enviando o valor da nova input
        fetch("/usuarios/cadastrarQuiz", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                errosServer: errosVar,
                acertosServer: acertosVar,
                fkUsuarioServer: fkUsuarioVar

            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log('responta ok')

                setTimeout(() => {
                    window.location = "./dashboard/dashboard.html";
                }, "2000")


            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
                console.log(' throw ("Houve um erro ao tentar realizar o cadastro!");')
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);

        });

        return false;
    }


    function limpar() {
        // aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo

        var fkUsuarioVar = Number(sessionStorage.getItem('ID_USUARIO'))

        
        console.log(fkUsuarioVar)
        // Enviando o valor da nova input
        fetch("/usuarios/limpar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                fkUsuarioServer: fkUsuarioVar

            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log('responta ok')

                // setTimeout(() => {
                //     window.location = "./dashboard/dashboard.html";
                // }, "2000")


            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
                console.log(' throw ("Houve um erro ao tentar realizar o cadastro!");')
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);

        });

        return false;
    }













</script>